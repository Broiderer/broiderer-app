"use client";
import { useEffect, useRef } from "react";
import styles from "./test-editor-2.module.scss";
import paper from "paper";
import elementToPath from "./utils/elementToPaperPath";
import { distance, getDataForStitches, getStiches } from "./utils/fillStitches";
import { subdividePathForPaperPath } from "./utils/subdividePath";
paper.setup(new paper.Size(1, 1));
paper.view.autoUpdate = false;

const ALLOWED_TAGS = [
  "rect",
  "circle",
  "polygon",
  "polyline",
  "ellipse",
  "path",
];
const OUTLINE_STEP = 5;
const FILL_STEP = 5;
const GRID_STEP = 20;
const ADDITIONAL_STITCH_START = 2;
const ADDITIONAL_STITCH_END = 2;
const RANDOMIZE_FIRST_FILLING_STEP = false;

const getAllNodes = (svgElement: SVGElement): SVGElement[] => {
  if (!svgElement) {
    return [];
  }
  return (ALLOWED_TAGS.includes(svgElement.tagName) ? [svgElement] : [])
    .concat([
      ...(Array.from(svgElement.childNodes) as any).map((node: SVGElement) =>
        getAllNodes(node)
      ),
    ])
    .flat();
};

export default function TestEditor2() {
  const svgRef = useRef<SVGSVGElement>(null);
  const svgPaperRef = useRef<SVGSVGElement>(null);

  useEffect(() => {
    if (!svgPaperRef.current || !svgRef.current) {
      return;
    }

    if (svgRef.current.getAttribute("viewBox")) {
      svgPaperRef.current.setAttribute(
        "viewBox",
        svgRef.current.getAttribute("viewBox")!
      );
    }

    if (svgRef.current.getAttribute("width")) {
      svgPaperRef.current.setAttribute(
        "width",
        svgRef.current.getAttribute("width")!
      );
    }

    if (svgRef.current.getAttribute("height")) {
      svgPaperRef.current.setAttribute(
        "height",
        svgRef.current.getAttribute("height")!
      );
    }

    svgPaperRef.current.innerHTML = "";

    const allNodes = getAllNodes(svgRef.current as any as SVGElement);

    const paperPaths = allNodes
      .map((originalNode, i) => {
        const { pathData, attributes } = elementToPath(originalNode);
        if (pathData) {
          const pathElmTest = new paper.Path(pathData);
          pathElmTest.data.fill = attributes.fill;
          pathElmTest.data.id = `shape-${i + 1}`;
          pathElmTest.closePath();

          return pathElmTest;
        } else {
          return null;
        }
      })
      .filter((el) => !!el);

    const isolatedPaths: paper.Path[] = [];
    paperPaths.forEach((path, i) => {
      if (!path) {
        return new paper.Path();
      }
      let pathT: paper.PathItem = path.clone();
      paperPaths.slice(i + 1).forEach((pathTmp) => {
        pathT = pathT.subtract(pathTmp!);
      });
      pathT.simplify(10)
      pathT.flatten(100);
      isolatedPaths.push(pathT as paper.Path);
    });

    const strokePaths = isolatedPaths.map((path) => {
      const newPath = subdividePathForPaperPath(path.clone(), OUTLINE_STEP);
      newPath.data.fill = "transparent";
      newPath.data.stroke = path?.data.fill;
      return newPath;
    });

    const stitchedPaths = isolatedPaths.map((path) => {
      const stitches = getStiches(
        path.clone()!.pathData,
        GRID_STEP,
        FILL_STEP,
        RANDOMIZE_FIRST_FILLING_STEP
      );
      const filteredStitches = stitches.filter(
        (stitch, i) => i === 0 || distance(stitch, stitches[i - 1]) > 1.1
      );
      const newData = getDataForStitches(filteredStitches);
      const newPath = new paper.Path();
      newPath.pathData = newData;
      newPath.data.fill = "transparent";
      newPath.data.stroke = path?.data.fill;
      return newPath;
    });

    [...stitchedPaths, ...strokePaths].forEach((path) => {
      for (let i = 0; i < ADDITIONAL_STITCH_START; i++) {
        path.insert(0, path.firstSegment.clone());
      }
      for (let i = 0; i < ADDITIONAL_STITCH_END; i++) {
        path.add(path.lastSegment.clone());
      }
    });

    const allPaths = stitchedPaths;

    strokePaths.forEach((path) => {
      const matchIndex = stitchedPaths.findIndex(
        (stitchPath) => stitchPath.data.id === path.id
      );
      allPaths.splice(matchIndex, 0, path);
    });

    const finalPath = new paper.Path();
    allPaths.forEach((path) => {
      finalPath.addSegments(path.segments);
    });

    const pathElm = document.createElementNS(
      "http://www.w3.org/2000/svg",
      "path"
    );
    pathElm.setAttribute("fill", "transparent");
    pathElm.setAttribute("stroke", "black");
    pathElm.setAttribute("d", finalPath!.pathData);

    svgPaperRef.current?.appendChild(pathElm);
  }, [svgPaperRef, svgRef]);

  const downloadPath = () => {
    console.log(svgPaperRef.current?.outerHTML);
  };

  return (
    <div className={styles["editor-svg"]}>
      <div id="test-editor-svg" className={styles["test-editor-svg"]}>
      <svg version="1.0" xmlns="http://www.w3.org/2000/svg" ref={svgRef}
 width="300" height="129" viewBox="112 -192 2882 1813">
<path d="M1680 1241 c-103 -21 -222 -58 -270 -81 -21 -10 -74 -21 -128 -25
-92 -7 -95 -8 -157 -55 -35 -26 -81 -53 -102 -60 -173 -52 -218 -74 -270 -129
l-52 -54 -73 16 c-88 20 -264 41 -334 41 -94 -1 -174 -79 -152 -149 5 -16 13
-75 18 -130 5 -55 13 -120 18 -145 6 -25 17 -79 26 -121 21 -103 48 -155 113
-212 70 -62 109 -64 180 -10 26 21 69 49 94 63 25 14 69 39 99 57 51 30 55 31
149 27 88 -4 202 -22 292 -45 20 -5 57 -9 82 -9 29 0 75 -12 124 -32 72 -29
87 -32 188 -32 74 0 145 7 215 21 116 24 217 25 385 4 56 -7 124 -10 155 -6
90 11 210 54 295 105 44 26 102 60 129 75 126 71 189 167 201 306 11 118 -3
157 -80 227 -35 31 -82 85 -105 119 -33 49 -53 67 -98 88 -30 14 -78 29 -106
32 -28 3 -69 15 -91 26 -165 83 -551 129 -745 88z m345 -11 c22 -5 83 -14 135
-20 100 -12 170 -32 260 -74 30 -14 72 -26 94 -26 21 0 65 -12 97 -26 47 -21
64 -36 94 -83 21 -31 68 -85 105 -121 82 -78 92 -106 81 -220 -6 -56 -17 -97
-37 -136 -31 -61 -109 -138 -162 -161 -18 -7 -70 -36 -115 -63 -46 -28 -117
-62 -158 -76 -84 -30 -172 -34 -444 -20 -135 8 -162 6 -265 -14 -153 -30 -278
-25 -367 13 -34 15 -79 27 -99 27 -20 0 -104 14 -187 31 -122 25 -168 30 -247
27 -93 -3 -100 -5 -151 -39 -30 -20 -65 -42 -79 -49 -14 -7 -47 -30 -75 -50
-86 -66 -121 -62 -202 22 -46 47 -66 92 -84 183 -6 33 -15 80 -20 105 -6 25
-14 90 -19 145 -5 55 -12 112 -15 126 -4 14 -2 44 4 66 16 59 65 86 140 80
129 -10 260 -28 323 -44 62 -15 68 -15 92 0 14 10 33 31 41 47 19 37 61 58
192 100 98 31 120 43 196 103 30 24 47 29 123 34 60 4 106 13 141 29 65 28
222 72 323 89 77 14 214 11 285 -5z"/>
<path d="M1760 1145 c-146 -19 -288 -57 -306 -84 -8 -11 -25 -21 -37 -20 -12
0 -16 3 -9 6 6 2 12 9 12 14 0 6 -21 -2 -46 -17 -33 -20 -58 -27 -89 -26 -52
2 -94 -12 -112 -38 -8 -11 -22 -20 -32 -20 -10 0 -40 -11 -66 -25 -27 -13 -62
-27 -78 -31 -42 -9 -157 -64 -157 -75 0 -5 23 -9 52 -9 l52 0 -60 -29 c-126
-63 -190 -82 -252 -75 -31 4 -82 17 -112 29 -50 21 -101 35 -140 40 -8 1 -41
5 -72 10 -47 6 -63 4 -83 -9 -14 -9 -23 -21 -21 -25 9 -14 96 -24 191 -22 60
2 102 -3 125 -12 19 -8 61 -18 93 -22 47 -5 58 -10 55 -23 -2 -11 -12 -16 -28
-15 -86 7 -210 7 -210 1 0 -13 45 -21 121 -22 50 -1 82 -6 93 -15 11 -9 13
-17 6 -21 -7 -4 -8 -15 -2 -31 6 -14 5 -36 0 -54 -6 -16 -10 -40 -9 -52 1 -17
-5 -23 -19 -23 -23 0 -26 10 -8 28 21 21 3 21 -30 0 -33 -21 -34 -38 -2 -38
10 0 22 -5 26 -11 3 -6 14 -9 24 -6 12 3 22 -3 29 -19 6 -13 19 -24 28 -24 10
0 68 -3 128 -6 61 -3 155 -5 209 -4 109 1 228 -20 279 -50 50 -30 136 -48 261
-56 84 -5 116 -4 116 5 0 7 -31 11 -94 11 -104 0 -207 20 -269 51 -74 38 -147
52 -297 55 -269 6 -325 9 -337 17 -7 4 -17 26 -23 47 -9 35 -8 43 11 70 18 24
27 28 48 23 14 -3 29 -11 33 -16 4 -6 22 -4 48 7 31 12 46 14 54 6 8 -8 18 -2
36 20 22 27 33 32 73 32 26 1 49 -1 50 -3 42 -57 72 -89 83 -89 17 0 19 17 2
22 -6 2 -9 12 -5 21 11 29 71 22 110 -13 35 -30 57 -38 57 -20 0 6 -4 10 -10
10 -16 0 -12 30 5 37 9 3 15 15 13 27 -2 16 3 22 24 24 22 3 32 -3 46 -28 l19
-31 6 28 c3 17 -1 39 -11 56 -16 26 -16 29 0 38 24 13 61 77 52 90 -5 8 -3 9
7 3 8 -4 43 -9 79 -10 75 -1 125 -12 195 -44 39 -18 67 -23 125 -22 41 0 88
-5 104 -12 28 -11 29 -14 31 -92 3 -113 40 -164 97 -132 14 7 56 12 102 11 70
0 78 1 61 13 -10 8 -22 14 -26 14 -8 0 -23 39 -17 45 11 11 58 16 58 6 0 -16
72 -91 87 -91 30 0 63 24 63 46 0 13 5 26 10 29 17 10 49 -5 55 -26 7 -22 25
-26 25 -5 0 23 20 29 39 12 10 -9 25 -16 35 -16 15 0 13 5 -10 29 -15 17 -31
28 -35 25 -14 -8 -20 15 -9 36 11 20 50 28 50 10 0 -5 11 -20 25 -34 19 -19
30 -23 52 -17 15 4 34 18 40 32 7 13 13 20 13 15 0 -6 5 -5 12 2 9 9 16 8 30
-5 17 -15 14 -17 -47 -38 -41 -15 -74 -34 -89 -52 -14 -16 -44 -36 -68 -43
-24 -8 -65 -25 -91 -38 -76 -36 -262 -54 -320 -31 -26 11 -27 13 -11 30 25 28
12 33 -32 12 -46 -22 -54 -40 -22 -52 18 -7 11 -9 -37 -13 -33 -2 -81 -14
-107 -26 -26 -12 -52 -22 -57 -22 -6 0 -11 -5 -11 -11 0 -6 6 -9 14 -6 8 3 16
2 18 -3 2 -5 36 -2 76 7 60 13 82 14 120 5 79 -20 204 -25 278 -13 79 13 200
69 258 118 22 18 46 33 54 33 27 0 142 85 168 123 31 48 36 71 22 103 -15 33
-26 30 -30 -8 -3 -28 -7 -34 -32 -36 -62 -7 -59 42 5 72 47 21 69 57 49 81 -7
8 -16 15 -21 15 -18 0 -167 133 -197 176 -32 45 -70 68 -107 66 -26 -2 -69 15
-127 51 -26 16 -51 26 -56 23 -5 -3 -33 1 -63 9 -64 17 -116 19 -121 4 -2 -5
-11 -7 -22 -3 -14 5 -15 9 -4 16 8 6 -10 8 -53 4 -43 -3 -79 0 -105 9 -46 17
-39 17 -174 0z m178 -23 c3 -10 -5 -13 -29 -10 -18 2 -34 9 -37 16 -3 10 5 13
29 10 18 -2 34 -9 37 -16z m-135 -33 c-3 -12 -14 -19 -29 -19 -28 0 -32 24 -7
38 24 14 42 4 36 -19z m417 9 c0 -13 -53 -6 -57 8 -2 7 8 9 27 6 16 -2 30 -9
30 -14z m-614 -8 c-46 -23 -59 -25 -54 -8 5 13 39 26 73 27 13 0 6 -7 -19 -19z
m283 -14 c0 -5 5 -12 13 -17 8 -5 5 -8 -10 -6 -30 2 -51 35 -21 33 10 0 19 -5
18 -10z m-204 -17 c0 -8 -12 -15 -30 -17 -30 -4 -30 -4 -11 17 21 23 41 23 41
0z m459 15 c28 -11 18 -34 -14 -34 -30 0 -43 23 -17 33 6 3 13 6 14 6 1 1 8
-2 17 -5z m146 -24 c0 -6 -11 -10 -25 -10 -23 0 -34 18 -19 33 9 8 44 -11 44
-23z m-292 3 c2 -9 -7 -13 -27 -13 -21 0 -31 5 -31 16 0 19 51 16 58 -3z
m-468 -3 c0 -12 -40 -33 -48 -25 -4 4 2 13 12 21 23 16 36 18 36 4z m238 -8
c3 -10 -10 -11 -46 -3 -2 1 0 6 3 12 9 13 37 8 43 -9z m472 -27 c10 -12 9 -15
-8 -15 -27 0 -52 10 -52 21 0 15 47 10 60 -6z m-592 -11 c-9 -10 -24 -14 -33
-10 -23 9 -9 26 23 26 24 0 25 -1 10 -16z m389 8 c6 -4 16 -19 22 -34 8 -23 7
-25 -9 -21 -21 6 -52 47 -43 57 8 8 15 7 30 -2z m302 -8 c8 -7 -12 -24 -29
-24 -18 0 -34 23 -23 34 6 6 42 -1 52 -10z m-983 -20 c-3 -9 -6 -20 -6 -26 0
-5 -6 -8 -12 -5 -7 2 -13 8 -13 13 0 5 -3 14 -7 19 -4 6 4 12 19 13 19 1 24
-2 19 -14z m799 -4 c0 -9 -11 -16 -27 -18 -23 -3 -28 1 -28 18 0 17 5 21 28
18 16 -2 27 -9 27 -18z m-411 -12 c13 -21 -2 -51 -26 -56 -16 -3 -27 29 -20
61 4 22 31 19 46 -5z m-328 -44 c-7 -25 -35 -34 -37 -11 -2 22 3 42 14 55 15
19 31 -11 23 -44z m498 41 c4 -11 -3 -19 -20 -25 -14 -6 -27 -10 -30 -10 -7 0
-5 36 3 43 12 13 41 7 47 -8z m504 -2 c2 -8 -6 -13 -22 -13 -26 0 -40 12 -29
24 11 11 46 2 51 -11z m-1153 -3 c5 -9 -50 -50 -67 -50 -18 0 -6 20 25 39 38
24 34 23 42 11z m270 -10 c7 -23 -12 -63 -28 -57 -14 4 -21 41 -13 63 8 21 34
17 41 -6z m-223 -47 c-2 -24 -8 -43 -13 -43 -5 0 -9 6 -9 13 0 6 -3 22 -6 35
-5 16 -2 22 10 22 9 0 16 5 16 12 0 6 2 9 3 7 2 -2 2 -23 -1 -46z m338 41 c0
-13 -21 -44 -30 -44 -14 0 -12 24 2 38 13 13 28 16 28 6z m334 -23 c16 -4 31
-12 34 -19 3 -10 -2 -10 -22 -1 -23 11 -30 9 -54 -14 -21 -20 -31 -24 -40 -15
-8 8 -15 8 -25 0 -11 -9 -18 -8 -31 6 -21 24 -12 33 25 25 31 -6 63 12 52 30
-4 7 0 8 13 2 10 -4 32 -10 48 -14z m601 8 c4 -6 5 -12 3 -14 -7 -7 -48 7 -48
16 0 13 37 11 45 -2z m-287 -11 c-3 -7 -15 -18 -29 -25 -29 -15 -48 -1 -29 22
15 18 64 21 58 3z m-138 -8 c0 -12 -41 -30 -53 -23 -4 3 -3 11 4 19 13 16 49
19 49 4z m274 -15 c-4 -9 0 -15 7 -15 8 0 29 -21 47 -45 52 -68 28 -106 -74
-119 -43 -5 -53 -3 -69 14 -10 11 -24 20 -30 20 -16 0 -26 25 -19 48 5 13 4
14 -4 3 -5 -7 -12 -9 -15 -4 -7 12 4 28 25 36 11 4 15 13 11 28 -5 19 -3 21
16 16 27 -7 93 11 86 24 -4 5 1 9 9 9 10 0 13 -6 10 -15z m197 -31 c8 -47 5
-54 -27 -54 -30 0 -76 43 -68 63 5 14 60 37 79 33 5 -2 13 -20 16 -42z m-547
20 c11 -30 6 -37 -14 -19 -11 10 -17 22 -14 26 8 14 21 11 28 -7z m-274 -19
c0 -12 -21 -25 -41 -25 -14 0 -11 38 4 43 18 6 37 -3 37 -18z m438 -21 c4 -2
-66 -74 -72 -74 -10 0 -6 49 4 55 6 3 10 20 10 37 l0 31 28 -24 c15 -13 28
-24 30 -25z m-1074 23 c-8 -23 -65 -60 -75 -50 -11 11 27 49 56 56 11 3 21 5
22 6 1 0 0 -5 -3 -12z m812 -15 c-13 -13 -18 -14 -28 -4 -10 10 -10 15 1 21 8
5 21 7 28 4 12 -5 12 -8 -1 -21z m-546 -26 c0 -40 -16 -55 -36 -34 -11 11 -12
21 -5 41 15 40 41 35 41 -7z m610 9 c0 -21 -39 -40 -54 -25 -8 8 -5 16 14 30
26 20 40 18 40 -5z m-340 -4 c0 -11 3 -26 6 -35 4 -10 -5 -20 -26 -31 -30 -15
-34 -15 -48 -1 -15 15 -15 19 2 51 22 40 66 51 66 16z m-487 -42 c-3 -11 -13
-24 -23 -29 -31 -17 -36 31 -6 68 8 11 12 11 22 -3 6 -9 10 -25 7 -36z m760
-36 c-14 -11 -22 -9 -50 18 -27 27 -30 35 -22 52 10 18 13 17 50 -19 36 -35
38 -40 22 -51z m-125 54 c3 -15 -1 -17 -25 -11 -37 9 -41 13 -23 25 21 13 44
7 48 -14z m270 -9 c-4 -29 -38 -38 -38 -10 0 22 8 32 27 32 9 0 13 -8 11 -22z
m-523 -8 c0 -8 -8 -16 -17 -18 -13 -2 -18 3 -18 18 0 15 5 20 18 18 9 -2 17
-10 17 -18z m-255 -10 c12 -21 3 -45 -26 -74 -38 -39 -62 -6 -38 54 18 45 46
53 64 20z m916 -11 c15 -17 16 -22 4 -29 -18 -11 -40 6 -40 31 0 25 12 24 36
-2z m-1124 -6 c30 -36 32 -46 7 -38 -23 7 -59 38 -59 50 0 12 38 3 52 -12z
m1516 -10 c-2 -14 -9 -29 -17 -31 -8 -3 -11 0 -7 6 4 7 2 21 -4 32 -9 17 -8
20 10 20 17 0 21 -5 18 -27z m86 18 c3 -5 -5 -16 -19 -25 -27 -18 -44 -4 -25
19 14 17 36 20 44 6z m-670 -16 c3 -9 -1 -18 -9 -21 -18 -7 -47 14 -39 27 9
15 41 10 48 -6z m510 9 c20 -7 21 -33 2 -40 -8 -3 -11 -15 -8 -30 2 -13 -1
-25 -7 -25 -6 -1 -15 -2 -20 -3 -6 0 -16 -7 -22 -13 -29 -29 -38 -5 -17 42 6
14 17 25 25 25 7 0 14 5 14 10 1 6 3 15 4 20 1 6 3 12 4 15 1 6 6 6 25 -1z
m-1587 -20 c2 -6 -6 -23 -18 -38 -19 -24 -24 -26 -36 -14 -21 22 0 70 29 66
12 -2 23 -8 25 -14z m798 -4 c0 -22 -29 -18 -33 3 -3 14 1 18 15 15 10 -2 18
-10 18 -18z m125 0 c14 -26 -12 -39 -62 -33 -28 4 -38 10 -38 22 0 26 9 31 51
31 28 0 41 -5 49 -20z m-1020 -7 c-1 -19 -16 -31 -29 -24 -7 5 -10 14 -7 20 8
12 36 15 36 4z m1450 -24 c0 -18 -35 -5 -38 14 -3 16 -1 17 17 7 12 -6 21 -15
21 -21z m-327 7 c3 -11 -30 -32 -38 -25 -3 4 -3 14 1 23 7 17 33 19 37 2z
m-773 -40 c0 -23 -30 -41 -48 -30 -23 15 -25 29 -7 48 12 12 21 13 36 6 10 -6
19 -17 19 -24z m891 21 c20 -15 34 -102 19 -112 -5 -3 -26 7 -45 22 -26 21
-35 36 -35 59 0 17 3 34 7 37 10 11 36 8 54 -6z m123 -51 c1 -48 1 -49 -31
-51 -33 -3 -33 -2 -33 41 0 30 5 46 18 53 33 20 44 9 46 -43z m-1422 29 c26 5
41 -20 33 -54 -9 -43 -18 -45 -53 -8 -23 24 -30 38 -25 55 3 15 9 19 17 13 6
-4 19 -7 28 -6z m176 -17 c-3 -20 -8 -23 -43 -20 -22 2 -44 7 -48 11 -4 4 5 6
21 3 18 -2 33 2 41 12 19 23 33 20 29 -6z m104 -18 c21 -43 22 -50 4 -50 -22
0 -76 52 -76 73 0 14 6 18 27 15 20 -2 33 -13 45 -38z m1498 5 c-14 -17 -40
-20 -40 -6 0 6 10 17 22 26 26 17 37 3 18 -20z m-1862 -21 c4 -25 -32 -59 -53
-51 -21 9 -19 29 6 56 24 25 43 23 47 -5z m1600 -1 c3 -20 -1 -23 -27 -23 -33
0 -46 13 -37 36 9 25 60 14 64 -13z m109 12 c5 -16 -19 -42 -44 -50 -20 -6
-23 -3 -23 23 0 16 3 32 7 36 10 10 56 3 60 -9z m211 -8 c2 -10 -3 -17 -12
-17 -10 0 -16 9 -16 21 0 24 23 21 28 -4z m-686 -28 c-4 -46 -18 -58 -33 -27
-8 19 -8 31 1 47 17 32 36 20 32 -20z m648 -14 c0 -14 -29 -35 -49 -35 -12 0
-15 33 -4 43 13 13 53 7 53 -8z m-533 -37 c39 -36 26 -68 -28 -68 -11 0 -28
-5 -38 -12 -43 -26 -70 21 -31 55 11 9 20 24 20 32 0 23 50 19 77 -7z m224
-21 c4 -25 2 -41 -7 -48 -18 -15 -34 -3 -34 25 0 12 -5 27 -11 33 -16 16 -1
35 24 31 16 -2 23 -12 28 -41z m389 -22 c0 -3 -31 -20 -68 -39 -38 -19 -82
-45 -98 -59 -36 -30 -145 -82 -202 -97 -49 -13 -182 -15 -257 -3 -60 9 -169 8
-210 -1 -26 -5 -25 -4 10 14 44 22 62 22 260 0 85 -9 122 -9 165 0 52 11 171
69 234 114 56 40 166 87 166 71z"/>{/* 
<path d="M2348 845 c-37 -34 -45 -65 -22 -82 10 -7 22 -13 28 -13 6 0 0 7 -12
16 -17 12 -20 19 -12 34 30 57 68 64 111 21 34 -34 35 -38 12 -63 -14 -15 -14
-18 -1 -18 16 0 48 31 48 46 0 6 -17 27 -38 47 -45 44 -76 47 -114 12z"/>
<path d="M2363 821 c-34 -28 -28 -45 19 -59 35 -11 43 -11 55 1 12 12 10 18
-12 45 -31 37 -33 37 -62 13z"/>
<path d="M2585 883 c-11 -3 -24 -8 -28 -13 -12 -10 21 -40 44 -40 14 0 19 7
19 30 0 17 -3 29 -7 29 -5 -1 -17 -3 -28 -6z"/>
<path d="M2620 951 c0 -12 29 -41 41 -41 15 0 10 16 -9 33 -21 19 -32 22 -32
8z"/>
<path d="M1430 731 c0 -4 30 -11 67 -14 37 -4 99 -18 138 -31 38 -13 90 -29
115 -34 l45 -10 -53 -1 c-29 0 -62 4 -73 9 -10 6 -19 7 -19 2 0 -18 57 -34 95
-26 30 5 37 4 33 -7 -6 -19 -84 -31 -140 -20 -27 4 -48 5 -48 1 0 -15 32 -20
116 -20 49 0 84 -4 84 -10 0 -6 -27 -10 -60 -10 -36 0 -60 -4 -60 -11 0 -7 18
-8 55 -4 36 5 55 4 55 -3 0 -12 -19 -19 -87 -32 -26 -5 -79 -16 -118 -25 -38
-9 -85 -19 -102 -22 -35 -6 -46 -23 -14 -23 10 0 36 6 57 14 22 7 64 17 94 21
30 4 74 13 98 21 49 16 111 19 97 5 -6 -5 -25 -13 -44 -18 -19 -5 -37 -15 -39
-22 -3 -10 0 -11 17 -1 12 6 32 10 44 8 23 -4 -2 -20 -136 -90 -56 -29 -44
-38 17 -13 29 13 168 95 185 111 3 2 -5 13 -17 24 -12 12 -22 32 -22 47 0 38
22 104 33 100 12 -4 14 -68 3 -86 -4 -6 -2 -18 4 -26 31 -37 67 0 67 68 0 43
-4 50 -29 63 -21 11 -37 12 -62 5 -40 -11 -106 0 -173 28 -71 30 -223 52 -223
32z"/>
<path d="M298 683 c-57 -6 -45 -22 15 -21 28 1 62 -2 75 -6 16 -5 22 -3 22 7
0 12 -49 31 -69 25 -3 -1 -23 -3 -43 -5z"/>
<path d="M1400 673 c-45 -20 -21 -30 31 -13 22 7 54 10 76 6 21 -3 54 -9 73
-12 56 -10 23 12 -38 25 -70 15 -100 13 -142 -6z"/>
<path d="M1386 621 c-3 -4 18 -11 47 -15 73 -8 127 -7 127 3 0 17 -164 29
-174 12z"/>
<path d="M423 592 c-24 -2 -43 -8 -43 -14 0 -7 16 -8 44 -4 25 4 47 3 50 -3 3
-5 14 -8 24 -6 9 2 38 7 65 10 26 3 47 10 47 16 0 8 -79 9 -187 1z"/>
<path d="M285 580 c-4 -6 8 -10 29 -10 20 0 36 5 36 10 0 6 -13 10 -29 10 -17
0 -33 -4 -36 -10z"/>
<path d="M1375 571 c-12 -12 10 -16 74 -13 39 2 71 8 71 13 0 10 -136 10 -145
0z"/>
<path d="M620 550 c-8 -6 -27 -10 -41 -10 -14 0 -29 -3 -33 -7 -4 -4 -41 -6
-83 -4 -54 2 -87 -2 -117 -14 -22 -10 -52 -22 -66 -27 -23 -9 -23 -11 -7 -22
14 -11 27 -8 78 16 47 22 75 29 127 29 37 1 73 5 79 11 7 6 21 8 31 6 10 -3
27 1 37 8 21 16 17 28 -5 14z"/>
<path d="M1565 553 c-22 -2 -49 -8 -60 -12 -11 -5 -44 -12 -74 -15 -29 -3 -56
-8 -59 -11 -13 -13 10 -15 64 -6 33 6 92 16 132 22 39 7 72 16 72 21 0 4 -8 7
-17 6 -10 -1 -36 -3 -58 -5z"/>
<path d="M1478 498 c-27 -6 -48 -14 -48 -19 0 -11 2 -11 56 2 24 6 44 15 44
20 0 5 -1 8 -2 8 -2 -1 -24 -6 -50 -11z"/>
<path d="M1575 449 c-75 -15 -95 -21 -95 -30 0 -5 7 -9 15 -9 26 0 135 34 135
43 0 4 -3 6 -7 6 -5 -1 -26 -5 -48 -10z"/>
<path d="M1843 446 c-13 -23 -81 -66 -142 -88 -31 -11 -60 -24 -66 -29 -29
-28 115 14 149 42 15 13 42 36 59 50 19 16 26 28 19 33 -6 3 -14 0 -19 -8z"/>
<path d="M395 438 c-32 -8 -85 -29 -114 -45 -2 -1 -1 -9 2 -17 5 -13 13 -12
57 4 29 11 63 26 76 35 13 8 30 15 39 15 8 0 15 5 15 10 0 12 -20 11 -75 -2z"/>
<path d="M1615 420 c-33 -16 -68 -29 -77 -30 -17 0 -27 -20 -10 -20 19 0 132
45 153 61 37 28 3 23 -66 -11z"/>
<path d="M530 394 c-30 -8 -64 -23 -75 -33 -11 -10 -36 -24 -55 -31 -56 -21
-58 -30 -7 -26 34 3 59 14 87 36 24 19 61 35 94 42 31 7 56 16 56 20 0 12 -38
9 -100 -8z"/>
<path d="M605 360 c-10 -11 -27 -20 -37 -20 -10 0 -29 -11 -42 -25 -13 -14
-30 -25 -37 -25 -8 0 -27 -11 -43 -25 -16 -14 -35 -25 -41 -25 -7 0 -18 -7
-25 -15 -11 -13 -9 -20 10 -40 30 -32 47 -32 62 0 6 13 19 27 30 30 10 4 18
11 18 16 0 5 7 9 15 9 8 0 27 18 41 40 15 22 31 40 36 40 15 0 68 40 68 51 0
17 -37 9 -55 -11z"/>
<path d="M1728 293 c-16 -2 -28 -9 -28 -15 0 -6 12 -8 31 -4 17 3 38 6 45 6 8
0 14 5 14 10 0 10 -12 11 -62 3z"/>
<path d="M355 281 c-22 -3 -40 -12 -40 -18 0 -7 2 -14 5 -14 13 -3 90 25 90
33 0 4 -3 7 -7 7 -5 -1 -26 -5 -48 -8z"/> */}
</svg>
      </div>

      <svg
        id="test-zone"
        xmlns="http://www.w3.org/2000/svg"
        ref={svgPaperRef}
      ></svg>
      <button onClick={downloadPath}>Download svg</button>
    </div>
  );
}
